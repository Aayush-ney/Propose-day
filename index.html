<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>For My Love üíñ | Kaluu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* MOBILE FIRST DESIGN */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            overscroll-behavior: none;
            touch-action: manipulation;
        }
        
        body {
            background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
            background-attachment: fixed;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            color: #5d3d5c;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            position: relative;
        }
        
        /* Main Container */
        .container {
            width: 100%;
            max-width: 100%;
            height: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* Cards - Mobile Optimized */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 30px 20px;
            width: 100%;
            max-width: 95vw;
            text-align: center;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.15),
                0 1px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: none;
            margin: 10px 0;
            animation: fadeIn 0.4s ease-out;
            position: relative;
        }
        
        .card.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* Header - Mobile Friendly */
        h1 {
            font-size: clamp(1.8rem, 6vw, 2.2rem);
            margin-bottom: 15px;
            color: #ff4d6d;
            font-weight: 700;
            line-height: 1.2;
            padding: 0 5px;
        }
        
        /* Name Styling */
        .name {
            font-size: clamp(1.2rem, 5vw, 1.4rem);
            font-weight: 600;
            margin: 12px 0;
            padding: 10px 20px;
            background: linear-gradient(45deg, #ff6b9d, #ff8e53);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            border-radius: 12px;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        /* Paragraphs */
        p {
            font-size: clamp(1rem, 4vw, 1.1rem);
            line-height: 1.6;
            margin: 12px 0;
            color: #444;
            padding: 0 5px;
        }
        
        .highlight {
            color: #ff4d6d;
            font-weight: 600;
            font-size: clamp(1.1rem, 4.5vw, 1.2rem);
            display: inline-block;
            margin: 10px 0;
        }
        
        /* Buttons - Touch Friendly */
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 300px;
            margin: 25px auto 0;
        }
        
        button {
            border: none;
            padding: 18px 24px;
            border-radius: 18px;
            font-size: clamp(1rem, 4.5vw, 1.1rem);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            touch-action: manipulation;
            min-height: 58px;
            user-select: none;
        }
        
        button:active {
            transform: scale(0.97);
            box-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        #yesBtn {
            background: linear-gradient(145deg, #ff4d6d, #ff6b9d);
            color: white;
        }
        
        #noBtn {
            background: #f0f0f0;
            color: #666;
        }
        
        #goGameBtn {
            background: linear-gradient(145deg, #36d1dc, #5b86e5);
            color: white;
        }
        
        /* Love Messages */
        .message-container {
            min-height: 180px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 240, 245, 0.7);
            border-radius: 20px;
            border-left: 4px solid #ff4d6d;
            overflow-y: auto;
            max-height: 300px;
        }
        
        .typing-text {
            font-size: clamp(1rem, 4vw, 1.1rem);
            line-height: 1.8;
            color: #333;
            text-align: left;
        }
        
        /* Game Section - HARDER MODE */
        .game-area {
            margin: 20px 0;
            width: 100%;
        }
        
        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #666;
            background: rgba(255, 255, 255, 0.3);
            padding: 10px 15px;
            border-radius: 15px;
        }
        
        .stat-box {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ff4d6d;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .love-meter-container {
            width: 100%;
            height: 25px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid #ffc3a0;
        }
        
        #loveMeter {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff6b9d, #ff8e53);
            border-radius: 15px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .meter-text {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Game Container - Smaller hearts, faster movement */
        #heartContainer {
            position: relative;
            width: 100%;
            height: 350px;
            margin: 20px 0;
            border-radius: 20px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.15);
            border: 2px dashed #ff6b9d;
        }
        
        .game-heart {
            position: absolute;
            font-size: 28px; /* Smaller hearts */
            cursor: pointer;
            transition: all 0.5s ease;
            z-index: 10;
            user-select: none;
            -webkit-user-select: none;
            animation: floatHeart 3s infinite alternate ease-in-out;
        }
        
        @keyframes floatHeart {
            0% { transform: translateY(0px) rotate(0deg); }
            100% { transform: translateY(-15px) rotate(5deg); }
        }
        
        .heart-missed {
            opacity: 0.4;
            filter: grayscale(0.7);
        }
        
        /* Timer */
        .timer {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 77, 109, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* Difficulty Level */
        .difficulty {
            display: inline-block;
            background: linear-gradient(45deg, #ff4d6d, #ff8e53);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        /* Floating Hearts Background */
        .floating-heart {
            position: fixed;
            font-size: 20px;
            opacity: 0;
            pointer-events: none;
            z-index: -1;
            animation: floatUp 5s linear forwards;
        }
        
        @keyframes floatUp {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Music Control */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            z-index: 100;
            border: 2px solid #ff4d6d;
        }
        
        .music-control i {
            font-size: 1.5rem;
            color: #ff4d6d;
        }
        
        /* Loading Screen */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ff4d6d;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: white;
            font-size: 1.2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            text-align: center;
            padding: 0 20px;
        }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background: #ff4d6d;
            pointer-events: none;
            opacity: 0.8;
            border-radius: 50%;
        }
        
        /* Game Over Screen */
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 20px;
            z-index: 20;
            color: white;
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .game-over.active {
            display: flex;
        }
        
        .retry-btn {
            background: #ff4d6d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }
        
        /* Portrait/Landscape adjustments */
        @media (max-width: 380px) {
            .card {
                padding: 20px 15px;
            }
            
            button {
                padding: 16px 20px;
                min-height: 54px;
            }
            
            #heartContainer {
                height: 300px;
            }
            
            .game-heart {
                font-size: 24px;
            }
        }
        
        @media (min-height: 700px) {
            #heartContainer {
                height: 400px;
            }
        }
        
        @media (min-width: 768px) {
            .buttons {
                flex-direction: row;
                max-width: 500px;
            }
            
            button {
                width: auto;
                min-width: 160px;
            }
            
            #heartContainer {
                height: 450px;
            }
        }
        
        /* Hide scrollbar but allow scrolling */
        ::-webkit-scrollbar {
            width: 5px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #ff6b9d;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading" id="loadingScreen">
        <div class="loader"></div>
        <div class="loading-text">Loading our love story... üíñ</div>
    </div>
    
    <!-- Music Control -->
    <div class="music-control" id="musicToggle">
        <i class="fas fa-music"></i>
    </div>
    
    <div class="container">
        <!-- Page 1: Proposal -->
        <div id="page1" class="card active">
            <h1>Happy Propose Day üíñ</h1>
            <div class="name">Susma Karki üå∏</div>
            <p>From the moment you entered my life, everything became more beautiful.</p>
            <p>Your smile is my favorite view, your laugh is my favorite sound.</p>
            <p class="highlight">I want to spend every day loving you more than the day before.</p>
            <p><strong>Will you make me the happiest person and be mine forever? üíç</strong></p>
            
            <div class="buttons">
                <button id="yesBtn">
                    <i class="fas fa-heart"></i> YES, I WILL! ‚ù§Ô∏è
                </button>
                <button id="noBtn">
                    <i class="fas fa-times"></i> MAYBE LATER
                </button>
            </div>
        </div>
        
        <!-- Page 2: Love Messages -->
        <div id="page2" class="card">
            <h1>My Heart's Message üíå</h1>
            <div class="message-container">
                <div id="loveMessage" class="typing-text"></div>
            </div>
            <div class="buttons">
                <button id="goGameBtn">
                    <i class="fas fa-gamepad"></i> LOVE CHALLENGE üíñ
                </button>
            </div>
        </div>
        
        <!-- Page 3: Mini-game -->
        <div id="page3" class="card">
            <h1>Prove Your Love üíï</h1>
            <p class="difficulty">HARD MODE ‚ö°</p>
            <p>Catch the moving hearts before they disappear!</p>
            <p>You need 50 hearts in 60 seconds to win my heart! ‚è∞</p>
            
            <div class="game-stats">
                <div class="stat-box">
                    <div class="stat-value" id="score">0</div>
                    <div class="stat-label">Hearts</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="missed">0</div>
                    <div class="stat-label">Missed</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
            </div>
            
            <div class="game-area">
                <div class="love-meter-container">
                    <div id="loveMeter"></div>
                </div>
                <div class="meter-text">
                    <span>My Heart</span>
                    <span>Your Love</span>
                </div>
            </div>
            
            <div id="heartContainer">
                <div class="timer" id="timer">60s</div>
                <div class="game-over" id="gameOver">
                    <h2 id="gameResult">üéâ You Won!</h2>
                    <p id="gameMessage">You proved your love! üíñ</p>
                    <button class="retry-btn" id="retryBtn">Try Again üíò</button>
                </div>
            </div>
            <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">Hearts move and disappear quickly! Be fast! ‚ö°</p>
        </div>
    </div>

    <!-- Audio - Using YOUR music file -->
    <audio id="bgMusic" loop preload="auto">
        <!-- YOUR CUSTOM MUSIC FILE -->
        <source src="Ji Chanta Matina.m4a" type="audio/mp4">
        <source src="Ji Chanta Matina.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        // DOM Elements
        const page1 = document.getElementById('page1');
        const page2 = document.getElementById('page2');
        const page3 = document.getElementById('page3');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const goGameBtn = document.getElementById('goGameBtn');
        const music = document.getElementById('bgMusic');
        const musicToggle = document.getElementById('musicToggle');
        const loveMessage = document.getElementById('loveMessage');
        const loveMeter = document.getElementById('loveMeter');
        const heartContainer = document.getElementById('heartContainer');
        const loadingScreen = document.getElementById('loadingScreen');
        const scoreDisplay = document.getElementById('score');
        const missedDisplay = document.getElementById('missed');
        const accuracyDisplay = document.getElementById('accuracy');
        const timerDisplay = document.getElementById('timer');
        const gameOverScreen = document.getElementById('gameOver');
        const gameResult = document.getElementById('gameResult');
        const gameMessage = document.getElementById('gameMessage');
        const retryBtn = document.getElementById('retryBtn');
        
        // Game Variables - HARD MODE
        let yesClicked = false;
        let gameStarted = false;
        let musicPlaying = false;
        let musicLoaded = false;
        let gameActive = false;
        
        // Game Stats
        let score = 0;
        let missed = 0;
        let accuracy = 0;
        let timeLeft = 60;
        let gameTimer = null;
        let heartSpeed = 800; // Hearts appear faster
        let heartLife = 2000; // Hearts disappear faster
        let movingHearts = [];
        let totalHearts = 0;
        
        // Love messages
        const messages = [
            "My dearest Susma, üíñ",
            "From the first moment I saw you, I knew you were special.",
            "Every day with you feels like a beautiful dream.",
            "Your smile lights up my world like nothing else.",
            "I love the way you laugh, the way you care, everything about you.",
            "You're not just my love, you're my best friend, my partner, my everything.",
            "I promise to love you more with each passing day.",
            "Will you make me the happiest man and be mine forever?",
            "I love you more than words can express. üíï",
            "Forever yours... ‚ù§Ô∏è"
        ];
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            init();
        });
        
        function init() {
            // Start music immediately without asking
            startMusicImmediately();
            
            setupEventListeners();
            setupTouchSupport();
            createFloatingHearts();
            
            // Hide loading screen after 1 second
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                page1.classList.add('active');
            }, 1000);
        }
        
        // Start music immediately
        function startMusicImmediately() {
            // Set music to play automatically
            music.volume = 0.7;
            music.muted = false;
            
            // Try to play immediately on page load
            setTimeout(() => {
                const playPromise = music.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        musicPlaying = true;
                        musicLoaded = true;
                        console.log("Music playing automatically!");
                        musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                    }).catch(error => {
                        console.log("Auto-play blocked, will play on interaction");
                        // Music will play on first user interaction
                    });
                }
            }, 500);
            
            // Update music status
            music.addEventListener('play', function() {
                musicPlaying = true;
                musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
            });
            
            music.addEventListener('pause', function() {
                musicPlaying = false;
                musicToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
            });
            
            // Handle errors
            music.addEventListener('error', function(e) {
                console.error("Error loading music:", music.error);
            });
        }
        
        // Setup Event Listeners
        function setupEventListeners() {
            // YES Button
            yesBtn.addEventListener('click', handleYesClick);
            yesBtn.addEventListener('touchend', handleYesClick);
            
            // NO Button
            noBtn.addEventListener('touchstart', moveNoButton);
            noBtn.addEventListener('click', handleNoClick);
            
            // Game Button
            goGameBtn.addEventListener('click', () => switchToGame());
            goGameBtn.addEventListener('touchend', () => switchToGame());
            
            // Music Toggle
            musicToggle.addEventListener('click', toggleMusic);
            musicToggle.addEventListener('touchend', toggleMusic);
            
            // Retry Button
            retryBtn.addEventListener('click', restartGame);
            retryBtn.addEventListener('touchend', restartGame);
            
            // Start music on any user interaction if not playing
            const startMusicOnInteraction = (e) => {
                if (!musicPlaying && musicLoaded) {
                    music.volume = 0.7;
                    music.play().then(() => {
                        musicPlaying = true;
                        musicToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                    });
                }
            };
            
            document.addEventListener('click', startMusicOnInteraction, { once: true });
            document.addEventListener('touchstart', startMusicOnInteraction, { once: true });
        }
        
        // Setup Touch Support
        function setupTouchSupport() {
            document.addEventListener('contextmenu', (e) => e.preventDefault());
            
            heartContainer.addEventListener('touchstart', handleTouchStart, { passive: true });
            heartContainer.addEventListener('touchend', handleTouchEnd, { passive: true });
        }
        
        // Handle YES click/tap
        function handleYesClick(e) {
            e.preventDefault();
            if (yesClicked) return;
            yesClicked = true;
            
            // Ensure music is playing
            if (!musicPlaying && musicLoaded) {
                music.volume = 0.7;
                music.play().then(() => {
                    musicPlaying = true;
                });
            }
            
            // Switch to page 2
            switchPage(page1, page2);
            
            // Start typing messages
            typeMessages(0);
        }
        
        // Handle NO button
        function handleNoClick() {
            noBtn.innerHTML = '<i class="fas fa-heart-broken"></i> PLEASE SAY YES';
            noBtn.style.background = 'linear-gradient(145deg, #ff9999, #ff6666)';
            noBtn.style.color = 'white';
            setTimeout(() => {
                noBtn.innerHTML = '<i class="fas fa-times"></i> MAYBE LATER';
                noBtn.style.background = '#f0f0f0';
                noBtn.style.color = '#666';
            }, 1500);
        }
        
        // Move NO button on mobile touch
        function moveNoButton(e) {
            e.preventDefault();
            const card = page1.getBoundingClientRect();
            const maxX = card.width - noBtn.offsetWidth - 30;
            const maxY = card.height - noBtn.offsetHeight - 30;
            
            const randomX = Math.random() * maxX;
            const randomY = Math.random() * maxY;
            
            noBtn.style.position = 'absolute';
            noBtn.style.left = randomX + 'px';
            noBtn.style.top = randomY + 'px';
            noBtn.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
            noBtn.style.transition = 'all 0.3s ease';
        }
        
        // Toggle Music
        function toggleMusic(e) {
            e.preventDefault();
            e.stopPropagation();
            
            if (!musicLoaded) {
                music.load();
                return;
            }
            
            if (musicPlaying) {
                music.pause();
            } else {
                music.volume = 0.7;
                music.play().then(() => {
                    musicPlaying = true;
                });
            }
        }
        
        // Switch to Game
        function switchToGame() {
            switchPage(page2, page3);
            startLoveGame();
        }
        
        // Switch Pages
        function switchPage(fromPage, toPage) {
            fromPage.classList.remove('active');
            setTimeout(() => {
                toPage.classList.add('active');
            }, 300);
        }
        
        // Type Messages Effect
        function typeMessages(index) {
            if (index >= messages.length) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message-line';
            loveMessage.appendChild(messageDiv);
            
            const text = messages[index];
            let charIndex = 0;
            
            function typeChar() {
                if (charIndex < text.length) {
                    messageDiv.innerHTML += text.charAt(charIndex);
                    charIndex++;
                    setTimeout(typeChar, 50);
                } else {
                    messageDiv.innerHTML += '<br><br>';
                    setTimeout(() => typeMessages(index + 1), 800);
                }
            }
            
            typeChar();
        }
        
        // Start Love Game - HARD MODE
        function startLoveGame() {
            if (gameStarted) return;
            
            // Reset game state
            gameStarted = true;
            gameActive = true;
            score = 0;
            missed = 0;
            accuracy = 0;
            timeLeft = 60;
            totalHearts = 0;
            movingHearts = [];
            
            // Clear container
            heartContainer.innerHTML = '<div class="timer" id="timer">60s</div><div class="game-over" id="gameOver"><h2 id="gameResult">üéâ You Won!</h2><p id="gameMessage">You proved your love! üíñ</p><button class="retry-btn" id="retryBtn">Try Again üíò</button></div>';
            
            // Reattach event listeners
            document.getElementById('retryBtn').addEventListener('click', restartGame);
            document.getElementById('retryBtn').addEventListener('touchend', restartGame);
            
            // Update displays
            updateStats();
            timerDisplay.textContent = `${timeLeft}s`;
            
            // Start game timer
            gameTimer = setInterval(updateTimer, 1000);
            
            // Start creating hearts
            createHardHearts();
        }
        
        // Create hearts for hard mode
        function createHardHearts() {
            if (!gameActive) return;
            
            const heartCount = 3; // Create 3 hearts at once
            for (let i = 0; i < heartCount; i++) {
                setTimeout(() => createMovingHeart(), i * 300);
            }
            
            // Create more hearts faster
            if (gameActive) {
                setTimeout(createHardHearts, heartSpeed);
            }
        }
        
        // Create a moving heart
        function createMovingHeart() {
            if (!gameActive) return;
            
            totalHearts++;
            
            const heart = document.createElement('div');
            heart.innerHTML = 'üíñ';
            heart.className = 'game-heart';
            
            // Random starting position
            const startX = Math.random() * 80 + 10;
            const startY = Math.random() * 70 + 15;
            heart.style.left = startX + '%';
            heart.style.top = startY + '%';
            
            // Smaller size
            heart.style.fontSize = Math.random() * 15 + 20 + 'px';
            
            // Random movement direction
            const moveX = (Math.random() - 0.5) * 4;
            const moveY = (Math.random() - 0.5) * 4;
            
            // Add to moving hearts array
            const heartData = {
                element: heart,
                x: startX,
                y: startY,
                moveX: moveX,
                moveY: moveY,
                life: heartLife,
                missed: false
            };
            
            movingHearts.push(heartData);
            
            // Touch/click events
            heart.addEventListener('touchstart', (e) => {
                e.preventDefault();
                heart.style.transform = 'scale(1.3)';
            });
            
            heart.addEventListener('touchend', (e) => {
                e.preventDefault();
                collectHeart(heartData);
            });
            
            heart.addEventListener('click', (e) => {
                e.preventDefault();
                collectHeart(heartData);
            });
            
            heartContainer.appendChild(heart);
            
            // Remove heart after time if not collected
            setTimeout(() => {
                if (!heartData.missed && gameActive) {
                    heartData.missed = true;
                    heart.classList.add('heart-missed');
                    missed++;
                    updateStats();
                    
                    setTimeout(() => {
                        if (heart.parentNode) {
                            heart.remove();
                            movingHearts = movingHearts.filter(h => h !== heartData);
                        }
                    }, 500);
                }
            }, heartLife);
        }
        
        // Update moving hearts
        function updateMovingHearts() {
            if (!gameActive) return;
            
            movingHearts.forEach(heartData => {
                if (heartData.missed) return;
                
                // Move heart
                heartData.x += heartData.moveX;
                heartData.y += heartData.moveY;
                
                // Bounce off walls
                if (heartData.x < 5 || heartData.x > 95) {
                    heartData.moveX *= -1;
                }
                if (heartData.y < 10 || heartData.y > 90) {
                    heartData.moveY *= -1;
                }
                
                // Update position
                heartData.element.style.left = heartData.x + '%';
                heartData.element.style.top = heartData.y + '%';
                
                // Randomly change direction sometimes
                if (Math.random() < 0.02) {
                    heartData.moveX = (Math.random() - 0.5) * 4;
                    heartData.moveY = (Math.random() - 0.5) * 4;
                }
            });
            
            // Continue animation
            if (gameActive) {
                requestAnimationFrame(updateMovingHearts);
            }
        }
        
        // Collect heart
        function collectHeart(heartData) {
            if (heartData.missed || !gameActive) return;
            
            heartData.missed = true;
            score++;
            
            // Create collection effect
            createHeartAnimation(heartData.element.getBoundingClientRect());
            
            // Remove heart
            if (heartData.element.parentNode) {
                heartData.element.remove();
                movingHearts = movingHearts.filter(h => h !== heartData);
            }
            
            // Update stats and love meter
            updateStats();
            
            // Update love meter (harder: need 50 hearts for 100%)
            const progress = Math.min((score / 50) * 100, 100);
            loveMeter.style.width = progress + '%';
            loveMeter.textContent = Math.round(progress) + '%';
            
            // Check win condition
            if (score >= 50) {
                winGame();
            }
        }
        
        // Update game stats
        function updateStats() {
            scoreDisplay.textContent = score;
            missedDisplay.textContent = missed;
            
            accuracy = totalHearts > 0 ? Math.round((score / (score + missed)) * 100) : 0;
            accuracyDisplay.textContent = accuracy + '%';
        }
        
        // Update timer
        function updateTimer() {
            if (!gameActive) return;
            
            timeLeft--;
            timerDisplay.textContent = `${timeLeft}s`;
            
            if (timeLeft <= 0) {
                endGame();
            }
            
            // Increase difficulty as time runs out
            if (timeLeft <= 30) {
                heartSpeed = 600; // Even faster
                heartLife = 1500; // Even shorter life
            }
            if (timeLeft <= 15) {
                heartSpeed = 400;
                heartLife = 1200;
            }
        }
        
        // Win the game
        function winGame() {
            gameActive = false;
            clearInterval(gameTimer);
            
            gameResult.textContent = 'üéâ YOU WIN! üíñ';
            gameMessage.textContent = `You collected ${score} hearts with ${accuracy}% accuracy!\nMy heart is completely yours! üíï`;
            gameOverScreen.classList.add('active');
            
            showConfetti();
            setTimeout(() => {
                alert('üéâ You proved your love! You are amazing! üíñ\n\nThank you bebu malai maya garna ko lagi. love you bebuüíï');
            }, 1000);
        }
        
        // End game (time's up)
        function endGame() {
            gameActive = false;
            clearInterval(gameTimer);
            
            if (score >= 50) {
                winGame();
            } else {
                gameResult.textContent = '‚è∞ TIME\'S UP!';
                gameMessage.textContent = `You collected ${score} hearts (need 50).\nTry again to win my heart! üíò`;
                gameOverScreen.classList.add('active');
            }
        }
        
        // Restart game
        function restartGame() {
            gameOverScreen.classList.remove('active');
            startLoveGame();
        }
        
        // Handle touch events for game area
        let touchStartX = 0;
        let touchStartY = 0;
        
        function handleTouchStart(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        }
        
        function handleTouchEnd(e) {
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            
            const deltaX = Math.abs(touchEndX - touchStartX);
            const deltaY = Math.abs(touchEndY - touchStartY);
            
            if (deltaX < 10 && deltaY < 10) {
                const element = document.elementFromPoint(touchEndX, touchEndY);
                if (element && element.classList.contains('game-heart')) {
                    element.click();
                }
            }
        }
        
        // Create Heart Animation when collected
        function createHeartAnimation(position) {
            const heart = document.createElement('div');
            heart.innerHTML = 'üíñ';
            heart.style.position = 'fixed';
            heart.style.left = position.x + 'px';
            heart.style.top = position.y + 'px';
            heart.style.fontSize = '30px';
            heart.style.opacity = '1';
            heart.style.transition = 'all 0.5s ease-out';
            heart.style.zIndex = '1000';
            heart.style.pointerEvents = 'none';
            
            document.body.appendChild(heart);
            
            setTimeout(() => {
                heart.style.transform = 'translateY(-60px) scale(1.5)';
                heart.style.opacity = '0';
            }, 10);
            
            setTimeout(() => {
                heart.remove();
            }, 800);
        }
        
        // Create Floating Hearts Background
        function createFloatingHearts() {
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = Math.random() > 0.5 ? '‚ù§Ô∏è' : 'üíñ';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.fontSize = Math.random() * 15 + 15 + 'px';
                heart.style.color = getRandomHeartColor();
                heart.style.pointerEvents = 'none';
                
                document.body.appendChild(heart);
                
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.remove();
                    }
                }, 5000);
            }, 600);
        }
        
        // Show Confetti
        function showConfetti() {
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-20px';
                    confetti.style.backgroundColor = getRandomHeartColor();
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    confetti.style.pointerEvents = 'none';
                    
                    document.body.appendChild(confetti);
                    
                    const animation = confetti.animate([
                        { transform: `translateY(0) rotate(0deg)`, opacity: 1 },
                        { transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                    ], {
                        duration: Math.random() * 2000 + 1500,
                        easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                    });
                    
                    animation.onfinish = () => {
                        if (confetti.parentNode) {
                            confetti.remove();
                        }
                    };
                }, i * 15);
            }
        }
        
        // Helper function for random heart colors
        function getRandomHeartColor() {
            const colors = ['#ff4d6d', '#ff6b9d', '#ff8e53', '#ffb347', '#ff9999', '#ff6666', '#ff85a2', '#ff9770'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // Start heart movement animation
        function startHeartMovement() {
            updateMovingHearts();
        }
        
        // Start heart movement when game starts
        setTimeout(startHeartMovement, 1000);
    </script>
</body>
</html>
